---
layout: default
---







## AWS Billing

| Identifier    | Guardrail                                                                                                   | Rationale                                                                                                                                                                                                                                                     | Remediation                                                           | References                                                                                                                                             | IAM Actions                                                                                             |
|:--------------|:------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------------------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------|
| IAM-BILLING-1 | Check that the ability to modify or update AWS Billing options are only assumable to authorized principals. | In all AWS environments, ensure that only billing administrators and authorized principals should be able to update or modify AWS Billing options. Unauthorized modifications could affect your billing payments or account information such as email address | For unauthorized principals, either remove the associated IAM Actions | [https://docs.aws.amazon.com/IAM/latest/UserGuide/list_awsbilling.html](https://docs.aws.amazon.com/IAM/latest/UserGuide/list_awsbilling.html)<br><br> | aws-portal:ModifyBilling<br><br>aws-portal:ModifyAccount<br><br>aws-portal:ModifyPaymentMethods<br><br> |





## AWS Budgets

| Identifier    | Guardrail                                                                                                   | Rationale                                                                                                                                                                                                             | Remediation                                                           | References                                                                                                                                                                                   | IAM Actions                  |
|:--------------|:------------------------------------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------|
| IAM-BUDGETS-1 | Check that the ability to modify or update AWS Budgets options are only assumable to authorized principals. | In all AWS environments, ensure that only Budget administrators and authorized principals should be able to update or modify AWS Budgets options. Unauthorized modifications could affect your cost and usage budgets | For unauthorized principals, either remove the associated IAM Actions | [https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/budgets-managing-costs.html](https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/budgets-managing-costs.html)<br><br> | budgets:ModifyBudget<br><br> |





## Amazon CloudTrail

| Identifier       | Guardrail                                                          | Rationale                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Remediation                                                                                                                                                                                                      | References                                                                                                                                                                                                                                                                                                                                                               | IAM Actions                                                  |
|:-----------------|:-------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-------------------------------------------------------------|
| IAM-CLOUDTRAIL-1 | Check that Principals aren’t allowed to DeleteTrail or StopLogging | As Cloudtrail is the source for auditing of activity within your AWS Account, it is important to verify that this functionality cannot be disabled by most entities within your Organization. This permission should be limited to breakglass roles (those who own the logging capability). It is also important to call out that Cloudtrail supports Resource Level Permissions for individual trails, so this can be scoped to Infosec/Logging Team owned Trails if the usecase exists for other independent teams to need access to manage their own trails | Verify that DeleteTrail and StopLogging are explicitly denied to non-whitelisted Principals And That DeleteTrail and StopLogging permissions don’t exist in an Allow Statement for any non-whitelisted principal | [https://docs.aws.amazon.com/awscloudtrail/latest/userguide/security_iam_id-based-policy-examples.html https://docs.aws.amazon.com/IAM/latest/UserGuide/list_awscloudtrail.html](https://docs.aws.amazon.com/awscloudtrail/latest/userguide/security_iam_id-based-policy-examples.html https://docs.aws.amazon.com/IAM/latest/UserGuide/list_awscloudtrail.html)<br><br> | cloudtrail:DeleteTrail<br><br>cloudtrail:StopLogging<br><br> |
| IAM-CLOUDTRAIL-2 | Check that only authorized principals are able to UpdateTrail.     | Unauthorized principals could potentially turn off log file validation, turn off multi region trails, or turn off organizational trails. As Cloudtrail is the source for auditing of activity within your AWS Account, it is important to verify that this functionality is only for authorized principals within your Organization. Examples of authorized principals include break glass roles or those who own the logging capability, such as Security or the Logging Team.                                                                                | Verify that UpdateTrail is allowed only for authorized principals and denied for all else.                                                                                                                       | [https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_UpdateTrail.html](https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_UpdateTrail.html)<br><br>                                                                                                                                                                                         | cloudtrail:UpdateTrail<br><br>                               |





## AWS CodeCommit

| Identifier       | Guardrail                                                                   | Rationale                                                                                                                                                                                                                                                          | Remediation                                                                                                           | References   | IAM Actions                         |
|:-----------------|:----------------------------------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------|:-------------|:------------------------------------|
| IAM-CODECOMMIT-1 | DeleteRepository action for CodeCommit is only allowed to whitelisted roles | CodeCommit acts as the source of truth for the versioning of different projects used by the application and/or central IT teams. If privileges to delete repository are not clearly managed, it can lead to accidental deletion of repository leading to data loss | Addingaws:ResourceTag/${TagKey}in the IAM policy’s condition to only allow whitelisted roles to delete the repository |              | codecommit:DeleteRepository<br><br> |





## Amazon Elastic Compute Cloud (EC2)

| Identifier   | Guardrail                                                                                                                        | Rationale                                                                                                                                                                                                                                                                                                                                                                                                                             | Remediation                                                                                                                                                             | References                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | IAM Actions                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|:-------------|:---------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| IAM-EC2-1    | Check that the ability to terminate EC2 instances are appropriately scoped or are only assumable to authorized principals.       | In Production or Production-like environments,no one other than IaC tools should have access to delete resources. Even in development, unintentional termination of EC2 instances can delay project timelines or delivery. If ec2:TerminateInstances has a wildcard resource policy ( Resource *) that isn’t scoped with a condition statement such as ec2:ResourceTag, unauthorized EC2 instances might be inadvertently terminated. | For unauthorized principals, either remove ec2:TerminateInstances or appropriately scope with Condition keys. Remove ec2:TerminateIntances for unauthorized principals. |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | ec2:TerminateInstances<br><br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| IAM-EC2-2    | Check EC2 instances can only run instances with approved Amazon Machine Images (AMIs).                                           | For security hardening, vulnerability management, and configuration management purposes, only approved AMIs should be used to launch instances in Production or Production-like environments.                                                                                                                                                                                                                                         | Scope ec2:RunInstances resources to approved AMI ids or Use Condition tag with ec2:ResourceTag                                                                          | [https://aws.amazon.com/premiumsupport/knowledge-center/restrict-launch-tagged-ami/](https://aws.amazon.com/premiumsupport/knowledge-center/restrict-launch-tagged-ami/)<br><br>[https://aws.amazon.com/blogs/aws/amazon-ec2-resource-level-permissions-for-runinstances/](https://aws.amazon.com/blogs/aws/amazon-ec2-resource-level-permissions-for-runinstances/)<br><br>[https://docs.aws.amazon.com/IAM/latest/UserGuide/list_amazonec2.html#amazonec2-ec2_ResourceTag___TagKey_](https://docs.aws.amazon.com/IAM/latest/UserGuide/list_amazonec2.html#amazonec2-ec2_ResourceTag___TagKey_)<br><br> | ec2:RunInstances<br><br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| IAM-EC2-3    | Check that all network modification permissions are granted to authorized roles only, ideally the AWS Account provisioning role. | For all environments it is important to maintain and manage authorized network permitters and boundaries. Unauthorized network modifications could expose the network or service to attacks or data exfiltration. These actions are commonly associated with account provisioning rather than daily or frequent usage.                                                                                                                | Scope the following network infrastructure actions only to the AWS Account provisioning role.                                                                           | [https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_Operations.html](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_Operations.html)<br><br>                                                                                                                                                                                                                                                                                                                                                                                                                                         | ec2:AssociateDhcpOptions<br><br>ec2:AssociateRouteTable<br><br>ec2:AssociateSubnetCidrBlock<br><br>ec2:AssociateVpcCidrBlock<br><br>ec2:AttachInternetGateway<br><br>ec2:AttachVpnGateway<br><br>ec2:CreateCustomerGateway<br><br>ec2:CreateDhcpOptions<br><br>ec2:CreateInstanceExportTask<br><br>ec2:CreateInternetGateway<br><br>ec2:CreateRoute<br><br>ec2:CreateRouteTable<br><br>ec2:CreateSubnet<br><br>ec2:CreateVpc<br><br>ec2:CreateVpcEndpoint<br><br>ec2:CreateVpcEndpointServiceConfiguration<br><br>ec2:CreateVpcPeeringConnection<br><br>ec2:CreateVpnConnection<br><br>ec2:CreateVpnConnectionRoute<br><br>ec2:CreateVpnGateway<br><br>ec2:DeleteCustomerGateway<br><br>ec2:DeleteDhcpOptions<br><br>ec2:DeleteEgressOnlyInternetGateway<br><br>ec2:DeleteInternetGateway<br><br>ec2:DeleteNatGateway<br><br>ec2:DeleteNetworkAcl<br><br>ec2:DeleteNetworkAclEntry<br><br>ec2:DeleteRoute<br><br>ec2:DeleteRouteTable<br><br>ec2:DeleteSubnet<br><br>ec2:DeleteVpc<br><br>ec2:DeleteVpcEndpointServiceConfigurations<br><br>ec2:DeleteVpcEndpoints<br><br>ec2:DeleteVpcPeeringConnection<br><br>ec2:DeleteVpnConnection<br><br>ec2:DeleteVpnConnectionRoute<br><br>ec2:DeleteVpnGateway<br><br>ec2:DetachInternetGateway<br><br>ec2:DetachVpnGateway<br><br>ec2:DisableVgwRoutePropagation<br><br>ec2:DisassociateRouteTable<br><br>ec2:DisassociateSubnetCidrBlock<br><br>ec2:DisassociateVpcCidrBlock<br><br>ec2:EnableVgwRoutePropagation<br><br>ec2:ModifySubnetAttribute<br><br>ec2:ModifyVpcAttribute<br><br>ec2:ModifyVpcEndpoint<br><br>ec2:ModifyVpcEndpointServiceConfiguration<br><br>ec2:ModifyVpcEndpointServicePermissions<br><br>ec2:ModifyVpcPeeringConnectionOptionsconnection<br><br>ec2:ReplaceRoute<br><br>ec2:ReplaceRouteTableAssociation<br><br> |
| IAM-EC2-4    | Check that sensitive more frequently used EC2 actions are appropriately scoped to approprariate roles and resources.             | These EC2 actions might be more frequently needed, particularly in a development environment. However, these are sensitive EC2 permissions and should be appropriately scoped and for authorized roles only.                                                                                                                                                                                                                          | Secure using IAM condition statements and tags.                                                                                                                         | [https://docs.aws.amazon.com/IAM/latest/UserGuide/list_amazonec2.html#amazonec2-policy-keys https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_Operations.html](https://docs.aws.amazon.com/IAM/latest/UserGuide/list_amazonec2.html#amazonec2-policy-keys https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_Operations.html)<br><br>                                                                                                                                                                                                                                                   | ec2:InstanceSecurityGroup<br><br>ec2:AttachVolume<br><br>ec2:CopyImage<br><br>ec2:CopyFpgaImage<br><br>ec2:CreateFpgaImage<br><br>ec2:CreateImage<br><br>ec2:DeleteFpgaImage<br><br>ec2:DeregisterImage<br><br>ec2:DisassociateAddress<br><br>ec2:DisassociateIamInstanceProfile<br><br>ec2:ModifyFpgaImageAttribute<br><br>ec2:ModifyImageAttribute<br><br>ec2:ReplaceIamInstanceProfileAssociation<br><br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| IAM-EC2-5    | Check that only authorized principals can manage security groups.                                                                | A security group acts as a virtual firewall for your instance to control inbound and outbound traffic. Security groups act at the instance level, not the subnet level. Thus, security groups are one piece to providing network perimiter protection.                                                                                                                                                                                | For unauthorized principals, remove the permissions to invoke security group IAM actions.                                                                               | [https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html](https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html)<br><br>                                                                                                                                                                                                                                                                                                                                                                                                                                             | ec2:AuthorizeSecurityGroupEgress<br><br>ec2:AuthorizeSecurityGroupIngress<br><br>ec2:ApplySecurityGroupsToClientVpnTargetNetwork<br><br>ec2:CreateSecurityGroup<br><br>ec2:DeleteSecurityGroup<br><br>ec2:RevokeSecurityGroupEgress<br><br>ec2:RevokeSecurityGroupIngress<br><br>ec2:UpdateSecurityGroupRuleDescriptionsEgress<br><br>ec2:UpdateSecurityGroupRuleDescriptionsIngress<br><br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |





## Amazon Elastic Container Registry (ECR)

| Identifier   | Guardrail                                                               | Rationale                                                                                                                                                                                     | Remediation                                                                                                                                                                        | References                                                                                                                                                                                                                                                                                                                                                                                                                                     | IAM Actions                       |
|:-------------|:------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------------------------|
| IAM-ECR-2    | Check that only authorized principals are able to pull images from ECR. | An authorization token is used to manage authorization to ECR. Only authorized principals should have the ability to retrieve the authorization token, in order to protect any images in ECR. | For the action ecr:GetAuthorizationToken either: Explicitly grant to a list of authorized principals OR Consider usingaws:PrincipalOrgPathswhen multiple AWS Accounts need access. | [https://docs.aws.amazon.com/AmazonECR/latest/userguide/ecr_managed_policies.html#AmazonEC2ContainerRegistryReadOnly](https://docs.aws.amazon.com/AmazonECR/latest/userguide/ecr_managed_policies.html#AmazonEC2ContainerRegistryReadOnly)<br><br>[https://docs.aws.amazon.com/AmazonECR/latest/APIReference/API_GetAuthorizationToken.html](https://docs.aws.amazon.com/AmazonECR/latest/APIReference/API_GetAuthorizationToken.html)<br><br> | ecr:GetAuthorizationToken<br><br> |





## Amazon GuardDuty

| Identifier      | Guardrail                                                                                | Rationale                                                                                                                                                                                                                                           | Remediation                                                                              | References   | IAM Actions                             |
|:----------------|:-----------------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------|:-------------|:----------------------------------------|
| IAM-GUARDDUTY-1 | Ensure GuardDuty master account does not have permission to StopMonitoringMembers action | The master account should not have permissions to deregister a centralized member account unless it is done by a security admin Makes the accounts go “invisible” which can lead to malicious activities which cannot be viewed at org master level | Remove principal ARNs if they don’t meet the whitelisted role name and/or statement body |              | guardduty:StopMonitoringMembers<br><br> |





## AWS Identity and Access Management (IAM)

| Identifier   | Guardrail                                                                                                                          | Rationale                                                                                                                                                                                                                                                                                                                                                                                           | Remediation                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | References                                                                                                                                                                                                                                                                                                                                                                                                             | IAM Actions                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|:-------------|:-----------------------------------------------------------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| IAM-IAM-1    | Check that the management of AWS IAM Users, secret access keys, and multi-factor authentication is for authorized principals only. | While AWS IAM Users are typically not recommended today, in favor of federated principals, IAM Users might be needed for break glass procedures or operational availability when an identity provider is unavailable and federation is not possible. However, in general these actions are sensitive should be scoped appropriately.                                                                | Secure by restricting to Security Operations only and authorized roles.                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | [https://docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html](https://docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html)<br><br>                                                                                                                                                                                                                                                             | iam:AddUserToGroup <br><br> iam:AttachGroupPolicy<br><br> iam:CreateLoginProfile <br><br> iam:CreateUser<br><br> iam:CreateVirtualMFADeviceiam:DeactivateMFADevice<br><br> iam:DeleteAccessKey<br><br> iam:DeleteGroup<br><br> iam:DeleteGroupPolicy<br><br> iam:DeleteLoginProfile<br><br> iam:DeleteUser<br><br> iam:DeleteUserPolicy<br><br> iam:DeleteVirtualMFADevice<br><br> iam:DetachGroupPolicy<br><br> iam:DetachUserPolicy<br><br> iam:EnableMFADevice<br><br> iam:PutGroupPolicy<br><br> iam:PutUserPolicy<br><br> iam:RemoveUserFromGroup<br><br> iam:ResyncMFADevice<br><br> iam:UpdateAccessKey<br><br> iam:UpdateGroup<br><br> iam:UpdateLoginProfile<br><br> iam:UpdateUser <br><br>                                                                                                                                                                   |
| IAM-IAM-18   | Adding Managed Policy for denying high risk APIs                                                                                   | From the attacker perspective, walking through the first three steps of an attack (Reconnaissance, Scanning, and Access & Escalation), an attacker could leverage specific API calls in order to do damage to an AWS account. These particular APIs are what are commonly used in known attacks.                                                                                                    | Add a policy that specifically denies the APIs contained within the Reference section, and adding the policy to IAM Users and Roles that are used as service users/roles.                                                                                                                                                                                                                                                                                                                                                                            |                                                                                                                                                                                                                                                                                                                                                                                                                        | s3:ListBucket<br><br>s3:ListAllMyBuckets<br><br>lambda:ListFunctions<br><br>kms:ListKeys<br><br>kms:ListAliases<br><br>cloudtrail:DescribeTrails<br><br>cloudtrail:ListTrails<br><br>iam:*<br><br>organizations:DescribeAccount<br><br>organizations:DescribeOrganization<br><br>organizations:DescribeOrganizationalUnit<br><br>organizations:ListAccounts<br><br>organizations:ListAWSServiceAccessForOrganization<br><br>organizations:DescribePolicy<br><br>organizations:ListChildren<br><br>organizations:ListParents<br><br>organizations:ListPoliciesForTarget<br><br>organizations:ListRoots<br><br>organizations:ListPolicies<br><br>organizations:ListTargetsForPolicy<br><br>ec2:TerminateInstances<br><br>ec2:ModifyInstanceMetadataOptions<br><br>                                                                                                        |
| IAM-IAM-2    | Check that the management of IAM Roles and Policies for authorized principals only, ideally build automation roles only.           | The creation, update, and deletion of roles and policies and SAML provides needs to occur on approved changes to the IAM environment. However, these changes should be gated and restricted to authorized roles only, such as build automation, to prevent against any unintended principal granting themselves unauthorized permissions. The following permissions should be scoped appropriately. | Secure to only allow build automation.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | [https://docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html](https://docs.aws.amazon.com/IAM/latest/APIReference/API_Operations.html)<br><br>                                                                                                                                                                                                                                                             | iam:AttachRolePolicy<br><br> iam:AttachUserPolicy<br><br> iam:CreateAccountAlias<br><br> iam:UpdateAssumeRolePolicy <br><br> iam:CreateSAMLProvider <br><br> iam:CreateServiceLinkedRole <br><br> iam:DeleteAccountAlias <br><br> iam:DeleteAccountPasswordPolicy <br><br> iam:DeletePolicy <br><br> iam:DeletePolicyVersion <br><br> iam:DeleteRole <br><br> iam:DeleteRolePermissionsBoundary <br><br> iam:DeleteRolePolicy <br><br> iam:DeleteSAMLProvider <br><br> iam:DeleteServiceLinkedRole <br><br> iam:DeleteUserPermissionsBoundary <br><br> iam:DetachRolePolicy <br><br> iam:PutRolePermissionsBoundary <br><br> iam:PutRolePolicy <br><br> iam:PutUserPermissionsBoundary <br><br> iam:UpdateAccountPasswordPolicy <br><br> iam:UpdateAssumeRolePolicy <br><br> iam:UpdateRole <br><br> iam:UpdateRoleDescription <br><br> iam:UpdateSAMLProvider <br><br> |
| IAM-IAM-4    | IAM Policy Documents utilized as a Permissions Boundary are protected from modification from unauthorized entities                 | When utilizing a delegated admin model of IAM to allow developers to create their own roles - a permissions boundary is utilized to prevent privilege escalation. It is important to ensure that the Delegated Admins do not have access to modify the Policy Document used as their Permissions Boundary - this creates a risk of privilege escalation.                                            | Prevent the following IAM Actions: “iam:CreatePolicyVersion”, “iam:DeletePolicy”, “iam:DeletePolicyVersion”, “iam:SetDefaultPolicyVersion” on the ARN of the policy document that is utilized as the permissions boundary. This can be achieved as an outright deny at the SCP, or at the Permissions Boundary level. Utilizing IAM Paths (eg - a seperate path for Delegated Admins vs Protected IAM entities) to achieve the same outcome - as long as developers cannot edit their own Permissions Boundary, or alter the current policy version. | [https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_identifiers.html](https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_identifiers.html)<br><br>[https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_boundaries.html#access_policies_boundaries-delegate](https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_boundaries.html#access_policies_boundaries-delegate)<br><br> | iam:CreatePolicyVersion<br><br>iam:DeletePolicy<br><br>iam:DeletePolicyVersion<br><br>iam:SetDefaultPolicyVersion<br><br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| IAM-IAM-7    | iam:GetAccountAuthorizationDetails is limited to only whitelisted roles                                                            | Since this action provides all information (IAM principals and their relationship with each other) about your IAM constrcuts in an account it can be used for recon for unintended actions                                                                                                                                                                                                          | Removal of the action from the policy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | [https://docs.aws.amazon.com/IAM/latest/APIReference/API_GetAccountAuthorizationDetails.html](https://docs.aws.amazon.com/IAM/latest/APIReference/API_GetAccountAuthorizationDetails.html)<br><br>                                                                                                                                                                                                                     | iam:GetAccountAuthorizationDetails<br><br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| IAM-IAM-8    | iam:CreateUser is not allowed in roles/users who do not have business justification to have it                                     | In enterprise environment, the need for having permissions to create IAM users is negligible. The only use case would be for power user who creates on-demand users in case of an incident or emergency. Thus, general use roles should not be having this permission.                                                                                                                              | Removal of the action from the role unless it is whitelisted                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                        | iam:CreateUser<br><br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |





## AWS Key Management Service (KMS)

| Identifier   | Guardrail                                                                                       | Rationale                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Remediation                                                                                                                                                                                                                                                                                                                                      | References                                                                                                                                                                                             | IAM Actions                           |
|:-------------|:------------------------------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------|
| IAM-KMS-2    | Check that either only authorized principals or no principals can delete imported key material. | This is a potentially destructive action. Deletes key material that you previously imported. This operation makes the specified customer master key (CMK) unusable until the key material is reimported. All encrypted data is unreadable and unable to be decrypted until the customer reimports the exact same key material. A decision should be made if any break-glass roles should have this capability. These authorized roles should be whitelisted and all other rules should trigger a violation. | Permission kms:DeleteImportedKeyMaterial should only be for authorized principals. Ensure any attached policies are for authorized use cases only and have sufficient preventive controls and monitoring alerts. Enforce with preventive controls (e.g., service control policies). Detect on any AWS API calls to delete imported key material. | [https://docs.aws.amazon.com/kms/latest/developerguide/importing-keys-delete-key-material.html](https://docs.aws.amazon.com/kms/latest/developerguide/importing-keys-delete-key-material.html)<br><br> | kms:DeleteImportedKeyMaterial<br><br> |
| IAM-KMS-3    | Check that either only authorized principals or no principals can delete CMKs.                  | Deleting a CMK is a destructive and potentially dangerous operation. When a CMK is deleted, all data that was encrypted under the CMK is unrecoverable. Even in development this can be disruptive as there might be unnecessary downtime. The preventive control is to avoid ununauthorized capability of deleting CMKs. Relying on the 7 day waiting period and notificatons require appropriate detective controls.                                                                                      | Permission kms:ScheduleKeyDeletion should only be for authorized principals. Ensure any attached policies are for authorized use cases only and have sufficient preventive controls and monitoring alerts. Enforce with preventive controls (e.g., service control policies). Detect on any AWS API calls to delete CMKs                         | [https://docs.aws.amazon.com/kms/latest/APIReference/API_ScheduleKeyDeletion.html](https://docs.aws.amazon.com/kms/latest/APIReference/API_ScheduleKeyDeletion.html)<br><br>                           | kms:ScheduleKeyDeletion<br><br>       |
| IAM-KMS-4    | Check that either only authorized principals or no principals can disable CMKs.                 | If you disable a CMK, it cannot be used to encrypt or decrypt data until you re-enable it. This has immediate effectiveness. This could potentially incur downtime in a production environment. Even in development this can be disruptive as there might be unnecessary downtime.                                                                                                                                                                                                                          | Permission kms:DisableKey should only be for authorized principals. Ensure any attached policies are for authorized use cases only and have sufficient preventive controls and monitoring alerts. Enforce with preventive controls (e.g., service control policies). Detect on any AWS API calls to disable CMKs.                                | [https://docs.aws.amazon.com/kms/latest/developerguide/enabling-keys.html](https://docs.aws.amazon.com/kms/latest/developerguide/enabling-keys.html)<br><br>                                           | kms:DisableKey<br><br>                |
| IAM-KMS-5    | Check that either only authorized principals or no principals can place a new KMS key policy.   | Users with the PutKeyPolicy permission for a CMK can completely replace the key policy for a CMK with a different key policy of their choice.                                                                                                                                                                                                                                                                                                                                                               | Permission kms:PutKeyPolicy should only be for authorized principals. Ensure any attached policies are for authorized use cases only and have sufficient preventive controls and monitoring alerts. Enforce with preventive controls (e.g., service control policies). Detect on any AWS API calls to put key policy.                            | [https://d0.awsstatic.com/whitepapers/aws-kms-best-practices.pdf](https://d0.awsstatic.com/whitepapers/aws-kms-best-practices.pdf)<br><br>                                                             | kms:PutKeyPolicy<br><br>              |
| IAM-KMS-7    | Check that either only authorized principals or no principals can disable key rotation.         | Disabling key rotation will prevent the CMK from automatic annual rotation.                                                                                                                                                                                                                                                                                                                                                                                                                                 | Permission kms:DisableKeyRotation should only be for authorized principals. Ensure any attached policies are for authorized use cases only and have sufficient preventive controls and monitoring alerts. Enforce with preventive controls (e.g., service control policies). Detect on any AWS API calls to disable CMKs.                        | [https://docs.aws.amazon.com/kms/latest/developerguide/rotate-keys.html](https://docs.aws.amazon.com/kms/latest/developerguide/rotate-keys.html)<br><br>                                               | kms:DisableKeyRotation<br><br>        |





## Amazon Simple Storage Service (S3)

| Identifier   | Guardrail                                                                                                          | Rationale                                                                                                                                                                                        | Remediation                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | References                                                                                                                                                                                                                                                                                                                                                                                                                                                         | IAM Actions          |
|:-------------|:-------------------------------------------------------------------------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------------------|
| IAM-S3-2     | Check that the ability to get sensitive or classified information in S3 Objects is for authorized principals only. | Access to sensitive data must only be access to authorized principals. Unauthorized principals that are able to get S3 Objects would be able to read sensitive data and violate security policy. | Options include Complete removal of unauthorized principals from s3:GetObject. Scoping using condition keys to contain principal access to authorized S3 objects only. Encrypt at rest the S3 objects using a customer managed AWS CMKs to provide defense in depth. If the key policy prevents the unauthorized principal fro decrypting the data, then the unauthorized principal will not be able to decrypt the data, even if there were able to download the S3 object. | [https://aws.amazon.com/blogs/security/how-to-use-bucket-policies-and-apply-defense-in-depth-to-help-secure-your-amazon-s3-data/](https://aws.amazon.com/blogs/security/how-to-use-bucket-policies-and-apply-defense-in-depth-to-help-secure-your-amazon-s3-data/)<br><br>[https://docs.aws.amazon.com/IAM/latest/UserGuide/list_amazons3.html#amazons3-GetObject](https://docs.aws.amazon.com/IAM/latest/UserGuide/list_amazons3.html#amazons3-GetObject)<br><br> | s3:GetObject<br><br> |





## Amazon Simple Storage Service (S3) Access Points

| Identifier   | Guardrail                                                                                             | Rationale                                                                                                                                                                                                                                                                                              | Remediation                                                                                                                                                     | References                                                                                                                                                                                                       | IAM Actions                         |
|:-------------|:------------------------------------------------------------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:------------------------------------|
| IAM-S3-AP-1  | Check that the VPC mentioned in the S3-AccessEndpoint is valid VPC                                    | The Access Point cannot be edited once it has been created. If it has been created incorrectly, the only method is to delete the access point and create a new access point.                                                                                                                           | Check the VPC value provided in the API call payload for creating access point is a valid VPC in the account specified.                                         | [https://docs.aws.amazon.com/AmazonS3/latest/dev/creating-access-points.html](https://docs.aws.amazon.com/AmazonS3/latest/dev/creating-access-points.html)<br><br>                                               | s3:CreateAccessPoint<br><br>        |
| IAM-S3-AP-2  | Block Public access to buckets and objects through access points                                      | The block public access setting of the Access point should not be open to public unless really justified by customer requirements.                                                                                                                                                                     | Check `PublicAccessBlockConfiguration` setting of access point is set to not allow public access.                                                               |                                                                                                                                                                                                                  | s3:CreateAccessPoint<br><br>        |
| IAM-S3-AP-3  | Allow s3:GetObject and s3:PutObject on the S3 Access Points owned by the account.                     | If a user has IAM policies or bucket policies which allow authorized users to interact with the bucket's objects through access point, the s3:DataAccessPointAccount condition should be added to ensure only access points owned by the buckets are allowed to perform s3:GetObject and s3:PutObjects | Add s3:DataAccessPointAccount condition to the bucket policy to deny all GetObject and PutObject actions to  S3 Access point's owner account                    | [https://docs.aws.amazon.com/AmazonS3/latest/dev/creating-access-points.html#access-points-policies](https://docs.aws.amazon.com/AmazonS3/latest/dev/creating-access-points.html#access-points-policies)<br><br> | s3:DataAccessPointAccount<br><br>   |
| IAM-S3-AP-4  | Limit access to the S3 bucket only through a specific S3 Access Point for the bucket                  | Buckets which have specific access points enabled and do not have access pattern outside of access points. These buckets should have bucket policies which allow GetObject and PubObject only through the approved S3 Access Endpoints                                                                 | Add s3:DataAccessPointAccount condition to the bucket policy to deny all GetObject and PutObject actions to  S3 Access point's owner account                    | [https://docs.aws.amazon.com/AmazonS3/latest/dev/creating-access-points.html#access-points-policies](https://docs.aws.amazon.com/AmazonS3/latest/dev/creating-access-points.html#access-points-policies)<br><br> | s3:DataAccessPointAccount<br><br>   |
| IAM-S3-AP-5  | Limit access to the S3 bucket only to traffic originated from VPC and coming through S3 Access Points | Buckets which have S3 access points enabled should have bucket policy which limits access to them only through traffic originating from Amazon VPCs. This additional control prevents misconfiguration of bucket access pattern.                                                                       | Add s3:AccessPointNetworkOrigin condition with `VPC` value to the bucket policy to deny all GetObject and PutObject actions to  S3 Access point's owner account | [https://docs.aws.amazon.com/AmazonS3/latest/dev/creating-access-points.html#access-points-policies](https://docs.aws.amazon.com/AmazonS3/latest/dev/creating-access-points.html#access-points-policies)<br><br> | s3:AccessPointNetworkOrigin<br><br> |
| IAM-S3-AP-6  | Limit access to S3 bucket objects by restricting principals which have a common tag as the object     | Buckets which have S3 access points enabled should have S3 access point policy enabled which allows IAM principals to make call to the objects which are tagged with a particular value                                                                                                                | Add `s3:ExistingObjectTag` condition in the S3 Access Endpoint policy which has allows certain principals with the similar tags to get access to the objects    | [https://docs.aws.amazon.com/AmazonS3/latest/dev/creating-access-points.html#access-points-policies](https://docs.aws.amazon.com/AmazonS3/latest/dev/creating-access-points.html#access-points-policies)<br><br> | s3:GetObject<br><br>                |





## AWS Secrets Manager

| Identifier           | Guardrail                                                                                    | Rationale                                                                                                                                                                                                                                                                                                                                                                                                                                       | Remediation                                                                                                                                                                                                                                                                                                                               | References                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | IAM Actions                           |
|:---------------------|:---------------------------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------|
| IAM-SECRETSMANAGER-1 | Check that DeleteSecret is appropriately scoped and for authorized principals.               | Deleting a secret makes the secret immediately inaccessible and could impact applications that depend on the secret.                                                                                                                                                                                                                                                                                                                            | Check that Only authorized principals can invoke DeleteSecret Scope using secretsmanager:SecretId secretsmanager:AllowRotationLambdaArn or with a tag secretsmanager:ResourceTag/Optionally prevent disabling of the recovery window using theconditionssecretsmanager:ForceDeleteWithoutRecovery and secretsmanager:RecoveryWindowInDays | [https://docs.aws.amazon.com/secretsmanager/latest/userguide/manage_delete-restore-secret.html](https://docs.aws.amazon.com/secretsmanager/latest/userguide/manage_delete-restore-secret.html)<br><br>[https://docs.aws.amazon.com/secretsmanager/latest/apireference/API_DeleteSecret.html#SecretsManager-DeleteSecret-request-ForceDeleteWithoutRecovery](https://docs.aws.amazon.com/secretsmanager/latest/apireference/API_DeleteSecret.html#SecretsManager-DeleteSecret-request-ForceDeleteWithoutRecovery)<br><br>[https://docs.aws.amazon.com/secretsmanager/latest/userguide/reference_iam-permissions.html#iam-contextkeys](https://docs.aws.amazon.com/secretsmanager/latest/userguide/reference_iam-permissions.html#iam-contextkeys)<br><br> | secretsmanager:DeleteSecret<br><br>   |
| IAM-SECRETSMANAGER-2 | Check that only authorized principals are able to retrieve a secret value.                   | Sensitive or confidential information (e.g., credentials) would be expected to be stored in AWS Secrets Manager. Ensuring only authorized access reduces the risk of unauthorized access.                                                                                                                                                                                                                                                       | Check that only authorized principals can invoke GetSecretValue. Specify the Secret Resource Arn. Also, scope using the Condition key secretsmanager:SecretId or secretsmanager:ResourceTag/                                                                                                                                              | [https://docs.aws.amazon.com/secretsmanager/latest/apireference/API_GetSecretValue.html](https://docs.aws.amazon.com/secretsmanager/latest/apireference/API_GetSecretValue.html)<br><br>[https://docs.aws.amazon.com/secretsmanager/latest/userguide/reference_iam-permissions.html#iam-contextkeys](https://docs.aws.amazon.com/secretsmanager/latest/userguide/reference_iam-permissions.html#iam-contextkeys)<br><br>                                                                                                                                                                                                                                                                                                                                 | secretsmanager:GetSecretValue<br><br> |
| IAM-SECRETSMANAGER-3 | Check for separation of duties between managing a secret and reading or writing to a secret. | An administrator is required to manage creating secret via CreateSecret. Though populating the secret value including both reading GetSecretValue and writing the secret PutSecretValue should be performed by a separate principal, ideally only automation should be generating a (random) secret value and rotating the secret. Separating out the management from actually viewing the secret data reduces the risk of unauthorized access. | Check that the administration CreateSecret principal is separate from the secret value principal GetSecretValue and PutSecretValue.                                                                                                                                                                                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | secretsmanager:CreateSecret<br><br>   |





## Amazon Systems Manager (SSM)

| Identifier   | Guardrail                                                                                                                                                                                          | Rationale                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Remediation                                                                                                                                                                                                                                                                                            | References                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | IAM Actions              |
|:-------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-------------------------|
| IAM-SSM-1    | Check that usage of ssm:SendCommand is scoped via the usage of Resource Level Permissions or via the usage of conditions such as ssm:ResourceTag (no usage of * except for breakglass/admin roles) | ssm:RunCommand allows command execution on a machine that is managed by SSM (SSM Agent Installed and Instance Profile configured with proper permissions). If a wildcard resource is specified - this grants unrestricted access to command execution on all SSM Managed EC2 Instances across the account. While some usecases may legitimately require this access (Breakglass/Admin Accounts, IR, etc), the majority of roles should be scoped to have this access only to EC2 Instances required for function. | Usage of Resource Level Permissions - Specifiying the ARN of the instances needed in the statement of the policy arn:Partition:ec2:{Region}:Account:instance/{InstanceId} Or Usage of a tag condition - ec2:ResourceTag to scope usage of the command to only instances containing the appropriate tag | [https://docs.aws.amazon.com/IAM/latest/UserGuide/access_tags.html](https://docs.aws.amazon.com/IAM/latest/UserGuide/access_tags.html)<br><br>[https://docs.aws.amazon.com/IAM/latest/UserGuide/list_awssystemsmanager.html#awssystemsmanager-managed-instance](https://docs.aws.amazon.com/IAM/latest/UserGuide/list_awssystemsmanager.html#awssystemsmanager-managed-instance)<br><br>[https://docs.aws.amazon.com/systems-manager/latest/userguide/execute-remote-commands.html](https://docs.aws.amazon.com/systems-manager/latest/userguide/execute-remote-commands.html)<br><br> | ssm:SendCommand<br><br>  |
| IAM-SSM-2    | ssm:StartSession action with Resource * that doesnt have a condition statement such as ssm:ResourceTag                                                                                             | StartSession permission allows a principal to start an SSH session with the instance target. Unrestricted access to this can lead to logging into resources which may or may not be owned by the intended principal. Session manager should allow login into properly tagged resources only. If there are the instances being spun up either deliberately or accidentally with the appropriate tags it should not be accessible via SSH using Systems Manager                                                     | Usage of tag condition such as ssm:ResourceTag OR Removal of the ssm:StartSession action from the IAM policy                                                                                                                                                                                           | [https://docs.aws.amazon.com/systems-manager/latest/userguide/auth-and-access-control-permissions-reference.html](https://docs.aws.amazon.com/systems-manager/latest/userguide/auth-and-access-control-permissions-reference.html)<br><br>                                                                                                                                                                                                                                                                                                                                             | ssm:StartSession<br><br> |


